all: zip upload

zip:
	mkdir -p build
	rm -f ./build/skill.zip
	cp -r ./lambda_function.py ./my_finder build
	cp -r ./venv/lib/python2.7/site-packages/fuzzywuzzy build
	cp -r ./venv/lib/python2.7/site-packages/Levenshtein build
	find build -name "*.swp" | xargs rm -f
	echo "PROD = True # AUTOGENERATED"  > ./build/my_finder/stage.py
	cd build &&	zip -q -r skill.zip *

upload: zip
	aws lambda update-function-code --function-name MyFinder --zip-file fileb://build/skill.zip
